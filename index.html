<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Virtual Browser</title>
  <style>
    #browser-screen {
      width: 100%;
      height: 80vh;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>
  <h1>Virtual Browser</h1>
  <input type="text" id="url-input" placeholder="Enter URL" />
  <button id="navigate-button">Go</button>
  <div id="browser-screen"></div>

  <script>
    const ws = new WebSocket('ws://localhost:3000');

    const urlInput = document.getElementById('url-input');
    const navigateButton = document.getElementById('navigate-button');
    const browserScreen = document.getElementById('browser-screen');

    // Navigate to a new URL
    navigateButton.addEventListener('click', () => {
      const url = urlInput.value;
      ws.send(JSON.stringify({ type: 'navigate', url }));
    });

    // Handle clicks
    browserScreen.addEventListener('click', (e) => {
      const rect = browserScreen.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      ws.send(JSON.stringify({ type: 'click', x, y }));
    });

    // Handle typing
    document.addEventListener('keydown', (e) => {
      if (e.key.length === 1) { // Only emit printable characters
        ws.send(JSON.stringify({ type: 'type', text: e.key }));
      }
    });

    // Handle scrolling
    browserScreen.addEventListener('wheel', (e) => {
      ws.send(JSON.stringify({ type: 'scroll', deltaY: e.deltaY }));
    });

    // Update the browser screen (you'll need to implement this)
    ws.onmessage = (event) => {
      const data = JSON.parse(event.data);

      if (data.type === 'update-screen') {
        browserScreen.style.backgroundImage = `url(${data.image})`;
      }

      if (data.type === 'url-update') {
        urlInput.value = data.url;
      }
    };
  </script>
</body>
</html>